{% load i18n %}
{% load static %}
    <div class="p-5">
        <div class="flex justify-between items-center mb-2">
            <h2 class="text-md font-semibold">{% trans "Schedule Email" %}</h2>
            <button type="button" onclick="closeModal()" class="text-gray-500 hover:text-red-500 text-xl cursor-pointer cursor-pointer">
                <img src="{% static 'assets/icons/close.svg' %}" alt="Close" />
            </button>
        </div>
        {% if non_field_errors %}
        <div class="bg-red-50 text-red-500 px-3 py-2 rounded-md text-sm mb-4">
            {% for field, error in non_field_errors.items %}
                {{ error }}<br>
            {% endfor %}
        </div>
        {% endif %}

        <form id="schedule-form">
            <div class="mb-4">
                <label for="schedule_date" class="block text-sm font-medium text-gray-700 mb-2">
                    {% trans "Schedule Date" %}
                </label>
                <input
                    value ="{{ scheduled_at }}"
                    type="datetime-local"
                    id="schedule_datetime"
                    name="schedule_datetime"
                    required
                    class="mb-2 text-color-600 p-2 placeholder:text-xs  w-full border border-dark-50 rounded-md mt-1 focus-visible:outline-0 placeholder:text-dark-100 text-sm [transition:.3s] focus:border-primary-600"
                />
                {% if errors.schedule_datetime %}
                <div class="bg-red-50 text-red-500 px-3 py-2 rounded-md text-sm">{{ errors.schedule_datetime }}</div>
                {% endif %}
            </div>

            <div class="flex justify-end gap-2">
                <button
                    type="button"
                    {% if is_reschedule %}
                    hx-post="{% url 'horilla_mail:reschedule_mail_view' pk %}"
                    {% else %}
                    hx-post="{% url 'horilla_mail:schedule_mail_view' %}?model_name={{ model_name }}&object_id={{ object_id }}&pk={{pk}}"
                    hx-include="[name='from_mail'], [name='to_email'], [name='cc_email'], [name='bcc_email'], [name='subject'], #fileInput, #message_content, #schedule_datetime"
                    hx-on--before-request="syncEditorContent();"
                    {% endif %}
                    hx-encoding="multipart/form-data"
                    hx-swap="innerHTML"
                    hx-target="#modalBox"
                    hx-indicator="#schedule-spinner"
                    class="px-4 py-2 text-sm bg-primary-600 text-white rounded-md hover:bg-primary-800 flex items-center gap-2">
                    <span id="schedule-spinner" class="htmx-indicator">
                        <img src="{% static 'assets/icons/spinner.svg' %}" alt="Loading..." width="20">
                    </span>
                    {% trans "Schedule" %}
                </button>
            </div>
        </form>
    </div>
